# AGENT 共通ガイド

このドキュメントは、AI エージェントが共通で従うべきルールと作業手順をまとめたものです。

## 🔧 SAFETY FIRST

- **秘匿情報の保護**: API キーやパスワードなど機密情報はログ・回答に出力しない。必要に応じてマスキングする。
- **バイナリ/生成物の改変禁止**: 画像・実行ファイル等のバイナリは、ユーザーが明示した場合を除き変更しない。
- **破壊的操作の禁止**: `rm -rf`, `git reset --hard`, `git push` など戻せない操作は実行しない。
- **コード改変時の確認処理**: コード改変時のテスト、Lint、フォーマッターの利用はユーザーの指示がない場合は実行しない。
- **コード改変時のコメント方針**: 「なぜそうするのか」という背景を補足するコメントのみ許可する。コードの説明的コメントは追加しない。

## 🗣️ Communication

- コミュニケーションは **日本語** で行う。
- 指示・状況が曖昧な場合は、早い段階で質問し、前提を揃える。

## ⚙️ ワークフロー共通原則

- **影響範囲の調査 → 変更** の順番を徹底する。
- 変更は最小限に留め、元に戻せる状態を維持する。
- コマンド実行時は必要に応じて目的・期待結果・安全策を説明する。
- 検索には `rg`, `fd` など高速系 CLI を優先する。
- Web検索を行う際は `Gemini` を優先する。
    ```bash
    gemini -p "WebSearch: [検索キーワード]"
    ```
- github を参照する際は `gh` コマンドを利用する
- `git status`, `git diff` の結果を確認し、ユーザーには要約を共有する。

## 🌲 Git ワークフロー

- **Direct Push 禁止**: `master` ブランチへの直接のプッシュは行わない。
- **ブランチ作成**: 機能追加や修正を行う際は、必ず新しいブランチ（例: `feat/xxx`, `fix/xxx`）を作成する。
- **プルリクエスト (PR)**: 作業完了後は `gh pr create` を使用してプルリクエストを作成し、ユーザーのレビュー・承認を得てからマージする。
- **CI 確認**: PR 作成後は GitHub Actions のテストがパスしていることを確認する。

## 🤔 Thinking Template

1. **Context（背景）**: 状況と既存構成、依存関係を把握する。
2. **Goal(s)**: 成功条件と完了判定を明確にする。
3. **Constraints**: 技術・権限・リソース制約を整理する。
4. **Options & trade-offs**: 実現手段を複数検討し、メリット/デメリットを比較する。
5. **Chosen approach & why**: 採用案と根拠を説明する。
6. **Step-by-step plan**: 実行手順を順序付きでまとめ、必要なら Plan ツールに反映する。

## 🔍 Review

- 対象ファイル・関数などの範囲を明示して確認結果を整理する。
- 重要度順に Bug / Risk / Regression / Missing Test を列挙する。
- 不確かな点は質問として切り出し、想定や仮定を明記する。

## ✅ 完了チェックリスト

- 要求事項を満たしたか、成功条件と照らし合わせる。
- `git diff` を見直し、不要な差分やデバッグコードが含まれていないか確認する。
- 必要なテストやビルド手順があれば実行・案内する。未実施なら理由を明記する。
- 完了通知や次に行うべき操作があればユーザーへ提案する。
